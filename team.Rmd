---
title: "Lab 4"
author: "Maureen McDonald and Omima Hassan"
date: "10/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(plyr)
```

## Backgroup

An excerpt of the individual player data of the Cyclone football team is available from Canvas. Dowload the excel file and put the file next to your Rmd files. Data based on the defense, offense, and the biography of the players were imported.
```{r}
library(readxl)
defense <- read_excel('cyclonesFootball2018.xlsx', sheet='Defensive')
offense <- read_excel('cyclonesFootball2018.xlsx', sheet='Offensive')
bio <- read_excel('cyclonesFootball2018.xlsx', sheet='Biography')
```

References:

Iowa State University Athelete
A Beginnerâ€™s Guide to American Football for the rules of American football.

## Cleaning data

The player names and opponent names are changed to factors.
```{r}
Name= defense$Name= as.factor(defense$Name)
Opponent_Opponent= defense$Opponent_Opponent= as.factor(defense$Opponent_Opponent)

Name= offense$Name=offense$Name= as.factor(offense$Name)
Opponent_Opponent=offense$Opponent_Opponent= as.factor(offense$Opponent_Opponent)

Name= bio$Name= as.factor(bio$Name)
```

All offensive and defensive statistics are changed to numerical. The `Weight` column in Biography is also numeric. (Hint: look at `?mutate_at` if you want to save writing some code).

```{r}
Tackles_Solo= defense$Tackles_Solo=as.numeric(defense$Tackles_Solo)

Tackles_ASST= defense$Tackles_ASST=as.numeric(defense$Tackles_ASST)

Tackles_TFL= defense$Tackles_TFL=as.numeric(defense$Tackles_TFL)

Tackles_Sack= defense$Tackles_Sack=as.numeric(defense$Tackles_Sack)

Turnover_FF= defense$Turnover_FF=as.numeric(defense$Turnover_FF)

Turnover_FR= defense$Turnover_FR=as.numeric(defense$Turnover_FR)

Turnover_INT= defense$Turnover_INT=as.numeric(defense$Turnover_INT)

Pass_QBH= defense$Pass_QBH= as.numeric(defense$Pass_QBH)

Pass_PB= defense$Pass_PB= as.numeric(defense$Pass_PB)

Receiving_REC= offense$Receiving_REC= as.numeric(offense$Receiving_REC)

Receiveing_YDS= offense$Receiving_YDS=as.numeric(offense$Receiving_YDS)

Receiveing_TD= offense$Receiving_TD=as.numeric(offense$Receiving_TD)

Rushing_ATT= offense$Rushing_ATT=as.numeric(offense$Rushing_ATT)

Rushing_YDS= offense$Rushing_YDS=as.numeric(offense$Rushing_YDS)

Rushing_TD= offense$Rushing_TD=as.numeric(offense$Rushing_TD)

'Passing_CMP-ATT'= offense$'Passing_CMP-ATT'=as.numeric(offense$'Passing_CMP-ATT')

Passing_YDS= offense$Passing_YDS=as.numeric(offense$Passing_YDS)

Passing_TD= offense$Passing_TD=as.numeric(offense$Passing_TD)

Passing_INT= offense$Passing_INT=as.numeric(offense$Passing_INT)

Weight= bio$Weight= as.numeric(bio$Weight)
```

`Height` column was seperated into two columns. The newly created columns were changed to numerics.

```{r}
bio= bio %>% separate(Height, into= c("Feet", "Inches"))

Feet= bio$Feet=as.numeric(bio$Feet)
Inches= bio$Inches=as.numeric(bio$Inches)

bio= bio %>% select('Name', 'Weight', 'Feet', 'Inches', 'Hometown')
str(bio)
```

Then one column was created that represents `Height`. Drop any irrelavant columns from this process.
```{r}
bio=bio%>% unite(Height, Feet, Inches, sep="'")
head(bio)
```

By cleaning the three data frames in R, at the end of this step we have the following three clean data frames: `defClean`, `offClean`, and `bioClean`. Print the structures of these data frames.
```{r}
defClean= defense
offClean= offense
bioClean= bio

str(defClean)
str(offClean)
str(bioClean)
```

## Part two: Tidying (A)
For the following questions, work was done with the cleaned data frames `defClean`, `offClean`, and `bioClean`.

Reformat the `defClean` data frame into a tidy format using `gather`. The type of statistic (Tackles_Solo, Tackles_ASST, etc) is added as a **new key column named `Statistic`.** 
```{r}
head(defClean)
redefClean= defClean %>% gather(key= DefStat, value = Statistic, Tackles_Solo:Pass_PB)
head(redefClean)
```

A histogram for each defensive statistic was made. `facet_wrap` was used to draw all histograms in a single plot:

```{r}
ggplot(redefClean, aes(Statistic))+ geom_histogram(binwidth = 1) + facet_wrap(~DefStat)

```

The defensive skills that are rarest are Turnover_FR and Turnover_INT.

Did ISU have better defense against West Virginia or Kansas State? Answer this question by creating a scatterplot with x-axis being the number of solo tackles (by each player) against West Virginia, and y-axis being that against Kansas State. A large number of solo tackles indicates good defense.

```{r}

```


## Part two: Tidying  (B)

`Hometown` was seperated into two columns, city and state.
```{r}
bioClean= bioClean%>% separate(Hometown, into = c("City", "State"), sep = ",")
head(bioClean)
```

To answer how many players are from each state:
```{r}
count(bioClean$State)
```

## Part three: Joining data frames

Where the offensive players are from was found by joining the offensive data and player biography data appropriately.

```{r}
bo= inner_join(offClean, bioClean, by= c("Name"))
head(bo)
```


There isn't a clear representation to whether or not a relationship exist between weight of a player and receiving yards.
```{r}
ggplot(bo, aes(Receiving_YDS,Weight))+ geom_point()
```

Is there a relationship between weight and solo tackles?
```{r}
bd= inner_join(defClean, bioClean, by= c("Name"))
head(bd)
ggplot(bd, aes(Weight, Tackles_Solo))+ geom_point()
```

There is a negative relationship between weight and solo tackles. As your weight increases your solo tackles decreases.










